---
import { Picture } from "@astrojs/image/components";
import type { CropFit } from "@astrojs/image/dist/loaders";
import { twSizes } from "../lib";

interface Props {
  sizes: {
    sm: number;
    md?: number;
    lg?: number;
  };
  fit?: CropFit;
  src: string;
  className?: string;
  alt?: string;
}
const {
  sizes,
  src,
  fit = "cover",
  className = "",
  alt = "Picture",
} = Astro.props;
const widths = [sizes.sm, sizes.md, sizes.lg].filter((x) => x) as number[];
for (let i = 0; i < 3 - widths.length; i++) {
  const fallback = widths[3 - widths.length - 1]!;
  widths.push(fallback);
}
---

<Picture
  widths={widths}
  alt={alt}
  formats={["jpeg", "avif", "webp"]}
  quality={85}
  fit={fit}
  loading="lazy"
  sizes={twSizes(sizes)}
  aspectRatio={16 / 9}
  width={160}
  height={90}
  src={src}
  class={className}
/>
