---
import { getCollection } from "astro:content";
import PostsByCategory from "../components/PostsByCategory.astro";
import Default from "../layouts/Default.astro";
import { cleanName } from "../lib";

export async function getStaticPaths() {
  const categories = new Set(
    (await getCollection("posts")).map((post) => post.slug.split("/")[0])
  );
  console.log(categories);
  return [...categories].map((category) => {
    return {
      params: { category },
      props: { name: cleanName(category), id: category },
    };
  });
}
interface Props {
  name: string;
  id: string;
}

const { name, id } = Astro.props;
---

<Default title={name}>
  <PostsByCategory id={id} name={name} />
</Default>
